GAS LISTING C:\Users\VLADIS~1\AppData\Local\Temp/ccfyxX0i.s 			page 1


   1              		.file	1 "main.c"
   2              		.section .mdebug.abi32
   3              		.previous
   4              		.stabs	"C:\\Users\\Vladislav\\Desktop\\2/",100,0,0,$Ltext0
   5              		.stabs	"main.c",100,0,0,$Ltext0
   6              		.text
   7              	$Ltext0:
   8              		.stabs	"gcc2_compiled.",60,0,0,0
   9              		.stabs	"int:t1=r1;-2147483648;2147483647;",128,0,0,0
  10              		.stabs	"char:t2=r2;0;127;",128,0,0,0
  11              		.stabs	"long int:t3=r3;-2147483648;2147483647;",128,0,0,0
  12              		.stabs	"unsigned int:t4=r4;000000000000000000000000;000000000000037777777777;",128,0,0,0
  13              		.stabs	"long unsigned int:t5=r5;000000000000000000000000;000000000000037777777777;",128,0,0,0
  14              		.stabs	"long long int:t6=@s64;r6;001000000000000000000000;000777777777777777777777;",128,0,0,0
  15              		.stabs	"long long unsigned int:t7=@s64;r7;000000000000000000000000;001777777777777777777777;",128,
  16              		.stabs	"short int:t8=@s16;r8;-32768;32767;",128,0,0,0
  17              		.stabs	"short unsigned int:t9=@s16;r9;0;65535;",128,0,0,0
  18              		.stabs	"signed char:t10=@s8;r10;-128;127;",128,0,0,0
  19              		.stabs	"unsigned char:t11=@s8;r11;0;255;",128,0,0,0
  20              		.stabs	"__int128_t:t12=@s128;r12;000000000000000000000000;0377777777777777777777777777777777;",128
  21              		.stabs	"__uint128_t:t13=@s128;r13;000000000000000000000000;0377777777777777777777777777777777;",12
  22              		.stabs	"float:t14=r1;4;0;",128,0,0,0
  23              		.stabs	"double:t15=r1;8;0;",128,0,0,0
  24              		.stabs	"long double:t16=r1;8;0;",128,0,0,0
  25              		.stabs	"complex int:t17=s8real:1,0,32;imag:1,32,32;;",128,0,0,0
  26              		.stabs	"complex float:t18=R3;8;0;",128,0,0,0
  27              		.stabs	"complex double:t19=R4;16;0;",128,0,0,0
  28              		.stabs	"complex long double:t20=R4;16;0;",128,0,0,0
  29              		.stabs	"__builtin_va_list:t21=*22=22",128,0,0,0
  30              		.stabs	"_Bool:t23=@s8;-16;",128,0,0,0
  31              		.align	2
  32              		.globl	main
  33              	$LM1:
   1:main.c        **** /****************************************************************
   2:main.c        ****  *                       RISC_DSP project                       *
   3:main.c        ****  *                                                              *
   4:main.c        ****  *    Демонстрирует работу с DSP-ядром.                         *
   5:main.c        ****  *    Вообще-то у NVCom-01 два DSP-ядра, но работа с ними       *
   6:main.c        ****  *    полностью идентична. Поэтому здесь работаем только с      *
   7:main.c        ****  *    ядром DSP0. Ну и, разумеется, с CPU-ядром -               *
   8:main.c        ****  *    для управления DSP-ядрами                                 *
   9:main.c        ****  *                                                              *
  10:main.c        ****  ****************************************************************/
  11:main.c        **** 
  12:main.c        **** #include "nvcom_01.h"
  13:main.c        **** 
  14:main.c        **** // Адрес начала программы DSP-ядра
  15:main.c        **** extern int Start_DSP;
  16:main.c        **** extern long int InA;
  17:main.c        **** extern int InB;
  18:main.c        **** extern int InI;
  19:main.c        **** extern int OutC;
  20:main.c        **** 
  21:main.c        **** main()
  22:main.c        **** {
  34              		.stabn	68,0,22,$LM1
  35              		.ent	main
GAS LISTING C:\Users\VLADIS~1\AppData\Local\Temp/ccfyxX0i.s 			page 2


  36              	main:
  37              		.frame	$fp,24,$31		# vars= 16, regs= 1/0, args= 0, extra= 0
  38              		.mask	0x40000000,-8
  39              		.fmask	0x00000000,0
  40              	$LBB2:
  41 0000 E8FFBD27 		subu	$sp,$sp,24
  42 0004 1000BEAF 		sw	$fp,16($sp)
  43 0008 21F0A003 		move	$fp,$sp
  44              	$LM2:
  23:main.c        ****   int a = 3;
  45              		.stabn	68,0,23,$LM2
  46 000c 03000224 		li	$2,3			# 0x3
  47 0010 0000C2AF 		sw	$2,0($fp)
  48              	$LM3:
  24:main.c        ****   int b = 0;
  49              		.stabn	68,0,24,$LM3
  50 0014 0400C0AF 		sw	$0,4($fp)
  51              	$LM4:
  25:main.c        ****   int i = 0;
  52              		.stabn	68,0,25,$LM4
  53 0018 0800C0AF 		sw	$0,8($fp)
  54              	$LM5:
  26:main.c        ****   int c;
  27:main.c        **** 
  28:main.c        **** // Останавливаем ядро 0
  29:main.c        ****       DCSR(0)  = 0;
  55              		.stabn	68,0,29,$LM5
  56              		#.set	volatile
  57 001c 48B8013C 		sw	$0,-1203240704
  57      000120AC 
  58              		#.set	novolatile
  59              	$LM6:
  30:main.c        ****       SR(0)    = 0;
  60              		.stabn	68,0,30,$LM6
  61              		#.set	volatile
  62 0024 48B8013C 		sw	$0,-1203240700
  62      040120AC 
  63              		#.set	novolatile
  64              	$LM7:
  31:main.c        **** 
  32:main.c        **** // Пишем в счётчик команд ядра 0
  33:main.c        ****       PC(0)=((unsigned int)&Start_DSP - 0xb8440000)>>2;//(unsigned int)&PRAM)>>2;
  65              		.stabn	68,0,33,$LM7
  66 002c 0000033C 		la	$3,Start_DSP
  66      00006324 
  67 0034 BC47023C 		li	$2,1203503104			# 0x47bc0000
  68 0038 21106200 		addu	$2,$3,$2
  69 003c 82100200 		srl	$2,$2,2
  70              		#.set	volatile
  71 0040 48B8013C 		sw	$2,-1203240672
  71      200122AC 
  72              		#.set	novolatile
  73              	$LM8:
  34:main.c        **** 
  35:main.c        **** // Пишем в первый сегмент памяти даннных XRAM
  36:main.c        **** 
  37:main.c        ****         A0(0)=((unsigned int)&InA - 0xb8400000)>>2;//(unsigned int)&XRAM)>>2;
GAS LISTING C:\Users\VLADIS~1\AppData\Local\Temp/ccfyxX0i.s 			page 3


  74              		.stabn	68,0,37,$LM8
  75 0048 0000033C 		la	$3,InA
  75      00006324 
  76 0050 C047023C 		li	$2,1203765248			# 0x47c00000
  77 0054 21106200 		addu	$2,$3,$2
  78 0058 82100200 		srl	$2,$2,2
  79              		#.set	volatile
  80 005c 48B8013C 		sw	$2,-1203240832
  80      800022AC 
  81              		#.set	novolatile
  82              	$LM9:
  38:main.c        ****         A1(0)=((unsigned int)&InB - 0xb8400000)>>2;//(unsigned int)&XRAM)>>2;
  83              		.stabn	68,0,38,$LM9
  84 0064 0000033C 		la	$3,InB
  84      00006324 
  85 006c C047023C 		li	$2,1203765248			# 0x47c00000
  86 0070 21106200 		addu	$2,$3,$2
  87 0074 82100200 		srl	$2,$2,2
  88              		#.set	volatile
  89 0078 48B8013C 		sw	$2,-1203240828
  89      840022AC 
  90              		#.set	novolatile
  91              	$LM10:
  39:main.c        ****         A3(0)=((unsigned int)&InI - 0xb8400000)>>2;//(unsigned int)&XRAM)>>2;
  92              		.stabn	68,0,39,$LM10
  93 0080 0000033C 		la	$3,InI
  93      00006324 
  94 0088 C047023C 		li	$2,1203765248			# 0x47c00000
  95 008c 21106200 		addu	$2,$3,$2
  96 0090 82100200 		srl	$2,$2,2
  97              		#.set	volatile
  98 0094 48B8013C 		sw	$2,-1203240820
  98      8C0022AC 
  99              		#.set	novolatile
 100              	$LM11:
  40:main.c        ****         A2(0)=((unsigned int)&OutC - 0xb8400000)>>2;//(unsigned int)&XRAM)>>2;
 101              		.stabn	68,0,40,$LM11
 102 009c 0000033C 		la	$3,OutC
 102      00006324 
 103 00a4 C047023C 		li	$2,1203765248			# 0x47c00000
 104 00a8 21106200 		addu	$2,$3,$2
 105 00ac 82100200 		srl	$2,$2,2
 106              		#.set	volatile
 107 00b0 48B8013C 		sw	$2,-1203240824
 107      880022AC 
 108              		#.set	novolatile
 109              	$LM12:
  41:main.c        ****         InA = a;
 110              		.stabn	68,0,41,$LM12
 111 00b8 0000C28F 		lw	$2,0($fp)
 112 00bc 0000013C 		sw	$2,InA
 112      000022AC 
 113              	$LM13:
  42:main.c        ****         InB = b;
 114              		.stabn	68,0,42,$LM13
 115 00c4 0400C28F 		lw	$2,4($fp)
 116 00c8 0000013C 		sw	$2,InB
GAS LISTING C:\Users\VLADIS~1\AppData\Local\Temp/ccfyxX0i.s 			page 4


 116      000022AC 
 117              	$LM14:
  43:main.c        ****         InI = i;
 118              		.stabn	68,0,43,$LM14
 119 00d0 0800C28F 		lw	$2,8($fp)
 120 00d4 0000013C 		sw	$2,InI
 120      000022AC 
 121              	$LM15:
  44:main.c        ****         OutC = c;
 122              		.stabn	68,0,44,$LM15
 123 00dc 0C00C28F 		lw	$2,12($fp)
 124 00e0 0000013C 		sw	$2,OutC
 124      000022AC 
 125              	$LM16:
  45:main.c        **** 
  46:main.c        **** 
  47:main.c        **** // записываем значения входных переменных в память DSP-ядра
  48:main.c        **** 
  49:main.c        **** 
  50:main.c        **** // Запускаем ядро 0
  51:main.c        ****       DCSR(0) = 0x4000;
 126              		.stabn	68,0,51,$LM16
 127 00e8 00400224 		li	$2,16384			# 0x4000
 128              		#.set	volatile
 129 00ec 48B8013C 		sw	$2,-1203240704
 129      000122AC 
 130              		#.set	novolatile
 131              	$LM17:
  52:main.c        **** 
  53:main.c        **** // ждем окончания процедуры
  54:main.c        ****       while( !(QSTR_DSP & (1<<3)) ) ;
 132              		.stabn	68,0,54,$LM17
 133              	$L2:
 134              		#.set	volatile
 135 00f4 48B8023C 		lw	$2,-1203236860
 135      0410428C 
 136              		#.set	novolatile
 137 00fc 08004230 		andi	$2,$2,0x8
 138 0100 FCFF4010 		beq	$2,$0,$L2
 138      00000000 
 139              	$LM18:
  55:main.c        **** 
  56:main.c        **** // забираем результат
  57:main.c        ****       c = OutC;
 140              		.stabn	68,0,57,$LM18
 141 0108 0000023C 		lw	$2,OutC
 141      0000428C 
 142 0110 0C00C2AF 		sw	$2,12($fp)
 143              	$LM19:
  58:main.c        **** 
  59:main.c        **** // "лишний" оператор для установки контрольной точки, чтобы посмотреть значения переменных
  60:main.c        ****       while (1) ;
 144              		.stabn	68,0,60,$LM19
 145              	$L5:
 146 0114 45000008 		j	$L5
 146      00000000 
 147              	$LBE2:
GAS LISTING C:\Users\VLADIS~1\AppData\Local\Temp/ccfyxX0i.s 			page 5


 148              	$LM20:
  61:main.c        **** };
 149              		.stabn	68,0,61,$LM20
 150              		.end	main
 151              		.stabs	"main:F1",36,0,22,main
 152              		.stabs	"a:1",128,0,23,-24
 153              		.stabs	"b:1",128,0,24,-20
 154              		.stabs	"i:1",128,0,25,-16
 155              		.stabs	"c:1",128,0,26,-12
 156              		.stabn	192,0,0,$LBB2
 157              		.stabn	224,0,0,$LBE2
 158              	$Lscope0:
 159 011c 00000000 		.stabs	"",36,0,0,$Lscope0-main
